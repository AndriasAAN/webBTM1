rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * Helper function to check if the authenticated user is the designated admin.
     * @returns {boolean} True if the user's email is the admin email.
     */
    function isAdmin() {
      return request.auth != null && request.auth.token.email == "asse181086@gmail.com";
    }

    /**
     * @description Stores website settings. Publicly readable, but write access
     *              is restricted to the administrator.
     * @path /website_settings/{docId}
     */
    match /website_settings/{docId} {
      allow read: if true;
      allow write: if isAdmin();
    }

    /**
     * @description Stores news articles. Publicly readable, but write access
     *              is restricted to the administrator.
     * @path /news_articles/{docId}
     */
    match /news_articles/{docId} {
      allow read: if true;
      allow write: if isAdmin();
    }

    /**
     * @description Stores gallery photos. Publicly readable, but write access
     *              is restricted to the administrator.
     * @path /gallery_photos/{docId}
     */
    match /gallery_photos/{docId} {
      allow read: if true;
      allow write: if isAdmin();
    }
    
    /**
     * @description Manages admin roles. Only the designated admin can manage this collection.
     *              This collection is currently not used for authorization in favor of the
     *              hardcoded admin email, but the rule is kept for potential future use.
     * @path /roles_admin/{userId}
     */
    match /roles_admin/{userId} {
      allow read, write: if isAdmin();
    }
  }
}
